#include "predict.h"
#include "stdint.h"
#include "self_headfile.h"
#include "headfile.h"
//第一次录入
//int16_t pre_map[6][12][2] = 
//{{{30,130},{90,70},{170,50},{310,50},{410,90},{270,170},{190,150},{110,230},{110,350},{290,290},{310,370},{410,330}},  //1
//{{130,30},{170,110},{90,130},{150,190},{70,250},{170,270},{310,250},{390,110},{470,130},{390,270},{350,370},{430,350}},//2
//{{90,150},{170,90},{250,50},{330,30},{470,90},{390,210},{250,210},{170,270},{90,310},{250,330},{330,270},{430,330}},   //3
//{{50,150},{130,130},{210,90},{290,30},{450,110},{370,170},{290,130},{230,190},{130,270},{230,350},{350,270},{470,350}},//4
//{{130,110},{50,190},{130,230},{50,330},{150,330},{250,250},{250,130},{430,90},{410,170},{390,250},{350,350},{430,330}},   //5
//{{170,50},{110,110},{30,170},{110,350},{110,250},{170,170},{250,150},{310,70},{390,90},{390,210},{290,290},{430,350}}};  //6
//	
//第二次录入
int16_t pre_map[6][12][2] =
{{{110,130},{50,190},{50,330},{230,310},{270,230},{210,90},{330,50},{350,170},{450,110},{430,210},{350,350},{450,290}},
{{70,110},{50,190},{90,270},{170,250},{250,330},{310,230},{270,150},{190,90},{290,50},{430,50},{410,130},{450,350}},
{{50,190},{70,270},{90,350},{190,330},{250,230},{170,90},{270,50},{310,130},{390,70},{450,150},{330,310},{410,350}},
{{110,70},{70,150},{50,310},{170,230},{250,270},{350,250},{330,170},{210,110},{270,50},{410,90},{430,190},{450,350}},
{{150,50},{90,110},{50,230},{110,310},{230,270},{330,250},{310,150},{270,70},{450,50},{410,190},{350,370},{430,330}},
{{90,50},{170,90},{70,170},{50,330},{150,350},{270,310},{190,230},{290,110},{390,50},{350,170},{450,190},{410,290}}};
	
//每一张地图对应的目标物类型
//第一次录入
//uint8_t pre_type[6][12] = 
//{{31,25,12,35,22,15,24,32,14,11,34,21},   //1
//{31,15,25,34,14,13,33,24,35,11,23,21},    //2
//{34,15,35,22,11,14,21,12,31,32,24,25},    //3
//{33,21,31,12,23,32,13,11,25,15,22,35},    //4
//{13,24,31,34,32,22,23,33,14,11,21,12},    //5
//{34,14,33,15,25,11,31,13,24,35,23,21}};  //6

	
uint8_t pre_type[6][12] = 
{{33,15,25,31,11,13,22,32,35,21,23,12},   //1
{14,25,33,12,34,22,32,23,15,24,35,13},    //2
{21,11,31,24,12,14,35,22,15,34,32,25},    //3
{15,33,22,11,35,23,32,13,21,31,12,25},    //4
{35,31,25,15,11,34,24,13,21,14,23,33},    //5
{35,12,22,15,31,25,11,23,33,32,21,13}};  //6
uint8_t pre_num = 0;  //对应的地图数字
//确定地图
int8_t map_right()
{
	int8_t flag = -1;  //比对成功标志
	//统一坐标
//	for(uint8_t i=0;i<6;i++)
//	{
//		for(uint8_t j=0;j<12;j++)
//		{
//			pre_map[i][j][0] = pre_map[i][j][0]*20-10;
//			pre_map[i][j][1] = pre_map[i][j][1]*20-10;
//		}
//	}
	//最短距离
	uint16_t pre_min = 0;   
	uint16_t temp = 0;
	uint16_t temp_min = 65535;
	uint16_t right_pre = 65535;   //比对的最小的距离差
	for(uint8_t z = 0;z<6;z++)
	{
		pre_min = 0;
		
		temp = 0;
		for(uint8_t i=0;i<12;i++)
		{
			temp_min = 65535;
			for(uint8_t j=0;j<12;j++)
			{
				temp = sqrt((pos_XY[i][0] - pre_map[z][j][0])*(pos_XY[i][0] - pre_map[z][j][0])
						+ (pos_XY[i][1] - pre_map[z][j][1])*(pos_XY[i][1] - pre_map[z][j][1]));
				if(temp < temp_min)
				{
					temp_min = temp;
				}
			}
			pre_min += temp_min;
		}
		if(pre_min < right_pre)
		{
			right_pre = pre_min;
			pre_num = z;
			
		}
	}
//	lcd_showuint16(1,0,right_pre);
	//调整阈值
	if(right_pre < 200)
	{
		flag = pre_num;
	}
	return flag;
}